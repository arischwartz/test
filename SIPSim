#!/usr/bin/env python

#--- Option parsing ---#
"""
SIPSim: simulate gradient fractionation of microbial community DNA

Usage:
  SIPSim <command> [<args>...]
  SIPSim -l | --list
  SIPSim -h | --help
  SIPSim --version

Options:
  -l --list     List subcommands.
  -h --help     Show this screen.
  --version     Show version.

Commands:
  Use the `list` option.
Description:
  Simulate how taxa would be distributed in isopycnic gradients as assessed by
  high throughput sequencing.
"""

import os, sys
from docopt import docopt
from subprocess import call

 # application                                                                
scriptDir = os.path.dirname(__file__)
libDir = os.path.join(scriptDir, 'lib')
sys.path.append(libDir)                                                       
import Utils

subcmdDir = os.path.join(scriptDir, 'bin')


if __name__ == '__main__':
    args = docopt(__doc__,
                  version='0.1',
                  options_first=True)

    # list subcommands
    if args['--list']:
        Utils.list_subcmds(subcmdDir, '.py')
        exit()

    # calling subcommand scripts
    scriptFile = os.path.join(subcmdDir, args['<command>'] + '.py')
    if os.path.isfile(scriptFile):
        exit(call(['python', scriptFile] + args['<args>']))    
    else:
        msg = '"{}" is not a SIPSim command. See "SIPSim -h".'
        exit(msg.format(args['<command>']))
    
